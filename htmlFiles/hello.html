<!DOCTYPE html>
<html>
  <head>
  <meta charset="UTF-8">
    <style>
      #map {
        height: 400px;
        width: 100%;
       }
    </style>
  </head>
  <body>
	<h3 id="demo"></h3>
    <h3>My Google Maps Demo</h3>
    <div id="map"></div>
    <script>
      function initMap() {
        var glasgow = {lat: 37.0631420 , lng: -8.0441350};
        var map = new google.maps.Map(document.getElementById('map'), {
          zoom: 10,
          center: glasgow
        });
        var marker = new google.maps.Marker({
          position: glasgow,
          map: map
        });
	drawLine(map);
	
      }

	function drawLine(map){
		var xhttp = new XMLHttpRequest();
		xhttp.onreadystatechange = function() {
			if (this.readyState == 4 && this.status == 200) {
				myFunction(this);
			}
		};

		xhttp.open("GET", "cycling.gpx", true);
		xhttp.send();

		function myFunction(xml) {
			var xmlDoc = xml.responseXML.getElementsByTagName("gpx")[0];
			var trk1=xmlDoc.getElementsByTagName("trk")[0];
			var trkpoints=trk1.getElementsByTagName("trkpt");
			var flightPlanCoordinates=[];
			for(i=0; i<trkpoints.length; i++){
				var lati = trkpoints[i].getAttribute("lat");
		    		var long = trkpoints[i].getAttribute("lon");
				var coords = new google.maps.LatLng(trkpoints[i].getAttribute("lat"), trkpoints[i].getAttribute("lon"));
				flightPlanCoordinates.push(coords);
			}
			var flightPath = new google.maps.Polyline({
			  path: flightPlanCoordinates,
			  geodesic: true,
			  strokeColor: '#FF0000',
			  strokeOpacity: 1.0,
			  strokeWeight: 2
			});
			console.log(flightPath);
			flightPath.setMap(map);

		}

	}
    </script>
    <script async defer
    src="https://maps.googleapis.com/maps/api/js?key=AIzaSyAnKbdNHt9mOIkSxF2s71R8Cm5ZwFttV1Q&callback=initMap"/>
    </script>
	
  </body>
</html>
